This code is originally extracted from: https://www.compadre.org/osp/items/detail.cfm?ID=13352
but it has been modifyed in order to achieve our objectives.


